# Claude AI Instructions for Golf Swing AI Project

## Project Overview
This is a sophisticated iOS golf swing analysis app that provides AI-powered coaching, swing analysis, and conversational golf advice through CaddieChat.

## Core Architecture

### Key Components
- **DynamicGolfAI**: Intelligent conversational AI with context awareness and memory
- **LocalSwingAnalyzer**: On-device swing analysis using Core ML
- **CaddieChatView**: Main chat interface with dynamic AI responses
- **APIService**: Local-only processing for privacy
- **SwingAnalysisView**: Video-based swing analysis interface

### Recent Major Changes
- **Replaced hardcoded responses** with intelligent DynamicGolfAI system
- **Fixed duplicate welcome messages** by switching from NavigationLinks to tab switching
- **Added conversation memory** and user profiling for contextual responses
- **Implemented thread-safe** architecture with @MainActor annotations

## File Structure
```
Golf Swing AI/
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ DynamicGolfAI.swift           # Main conversational AI system
â”‚   â”œâ”€â”€ LocalCaddieChat.swift         # Fallback chat system
â”‚   â”œâ”€â”€ LocalAIManager.swift          # Core ML model management
â”‚   â””â”€â”€ API Service.swift             # Local processing service
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ CaddieChatView.swift          # Chat interface
â”‚   â”œâ”€â”€ SwingAnalysisView.swift       # Video analysis
â”‚   â””â”€â”€ HomeView.swift                # Main dashboard
â””â”€â”€ ContentView.swift                 # Tab navigation
```

## Critical Implementation Details

### DynamicGolfAI System
- **Context Analysis**: Uses NLP to understand golf questions in context
- **Conversation Memory**: Maintains history of exchanges for better responses
- **Response Generation**: Creates specific, relevant golf advice
- **User Profiling**: Builds user skill level and interest profile over time

### Chat Message Flow
1. User message â†’ `CaddieChatView.sendMessage()`
2. Message processed by `DynamicGolfAI.sendMessage()`
3. Contextual analysis performed by `ContextualAnalyzer`
4. Response generated by `DynamicResponseGenerator`
5. Conversation memory updated
6. Response displayed in chat UI

### Key Enums & Types
- **ChatIntent**: Types of golf questions (swingAdvice, equipment, strategy, etc.)
- **ConversationSentiment**: User emotion analysis
- **QuestionComplexity**: Simple/moderate/complex question classification
- **ChatResponse**: Standard response format with confidence scoring

## Common Tasks

### Adding New Golf Advice Categories
1. Add new case to `ChatIntent` enum in `DynamicGolfAI.swift`
2. Update topic extraction in `extractTopics()` method
3. Add response logic in `DynamicResponseGenerator.generateResponse()`
4. Update switch statements in `LocalCaddieChat.swift`

### Debugging Chat Issues
- Check console for "ðŸ¤– Processing:" messages
- Verify DynamicGolfAI initialization logs
- Check conversation memory state
- Review intent classification accuracy

### Thread Safety
- All AI classes use `@MainActor` for thread safety
- Conversation memory is actor-isolated
- UI updates happen on main thread automatically

## Testing Guidelines

### Chat Functionality
Test these specific scenarios:
- "How do I fix my driver from slicing?" â†’ Should get specific driver advice
- "What club for 200 yards?" â†’ Should get club selection guidance  
- Follow-up questions â†’ Should maintain context
- Non-golf questions â†’ Should redirect to golf topics

### UI Testing
- Single welcome message (no duplicates)
- Tab switching from HomeView buttons
- Loading states during AI processing
- Message formatting and display

## Build Requirements
- Xcode 15+
- iOS 17+ target
- Swift 6 concurrency enabled
- Core ML framework for local AI

## Troubleshooting

### Compilation Errors
- **"Ambiguous use of init()"**: Add explicit initializers
- **"Data races"**: Ensure @MainActor annotations on classes
- **"Switch must be exhaustive"**: Add missing ChatIntent cases

### Runtime Issues
- **No responses**: Check DynamicGolfAI initialization
- **Generic responses**: Verify response generation logic
- **Multiple welcome messages**: Check tab switching implementation
- **Memory leaks**: Review conversation memory cleanup

## Performance Considerations
- Local AI processing for privacy
- Conversation history limited to 50 exchanges
- Response generation optimized for 0.3s delay
- Memory management for large conversation logs

## Security Notes
- No external API calls for chat (local processing only)
- User data stays on device
- Conversation memory can be cleared
- No sensitive information logging

## Extension Points
- Add new golf knowledge domains
- Implement voice input/output
- Add swing correlation with chat advice
- Export conversation summaries
- Multi-language support

---
*Last updated: January 2025 - DynamicGolfAI Implementation*